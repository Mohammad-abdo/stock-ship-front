/**
 * Countries with dial codes for phone input.
 * dialCode: with + for API (e.g. "+966")
 * iso: ISO 3166-1 alpha-2 for flag (e.g. "SA")
 * nameEn, nameAr: for display
 */
function normalizeDialCode(raw) {
  if (!raw) return '+966';
  const first = String(raw).split(',')[0].trim();
  const main = first.includes('-') ? first.split('-')[0].trim() : first;
  const digits = main.replace(/\D/g, '');
  return digits ? `+${digits}` : '+966';
}

const NAME_AR_BY_ISO = {
  AF: 'أفغانستان', AL: 'ألبانيا', DZ: 'الجزائر', AD: 'أندورا', AO: 'أنغولا',
  AG: 'أنتيغوا وبربودا', AR: 'الأرجنتين', AM: 'أرمينيا', AU: 'أستراليا', AT: 'النمسا',
  AZ: 'أذربيجان', BS: 'باهاماس', BH: 'البحرين', BD: 'بنغلاديش', BB: 'بربادوس',
  BY: 'بيلاروسيا', BE: 'بلجيكا', BZ: 'بليز', BJ: 'بنين', BT: 'بوتان',
  BO: 'بوليفيا', BA: 'البوسنة والهرسك', BW: 'بوتسوانا', BR: 'البرازيل', BN: 'بروناي',
  BG: 'بلغاريا', BF: 'بوركينا فاسو', BI: 'بوروندي', KH: 'كمبوديا', CM: 'الكاميرون',
  CA: 'كندا', CV: 'الرأس الأخضر', CF: 'جمهورية أفريقيا الوسطى', TD: 'تشاد',
  CL: 'تشيلي', CN: 'الصين', CO: 'كولومبيا', KM: 'جزر القمر', CG: 'الكونغو',
  CR: 'كوستاريكا', HR: 'كرواتيا', CU: 'كوبا', CY: 'قبرص', CZ: 'التشيك',
  CD: 'الكونغو الديمقراطية', DK: 'الدنمارك', DJ: 'جيبوتي', DM: 'دومينيكا',
  DO: 'جمهورية الدومينيكان', EC: 'الإكوادور', EG: 'مصر', SV: 'السلفادور',
  GQ: 'غينيا الاستوائية', ER: 'إريتريا', EE: 'إستونيا', SZ: 'إسواتيني', ET: 'إثيوبيا',
  FJ: 'فيجي', FI: 'فنلندا', FR: 'فرنسا', GA: 'الغابون', GM: 'غامبيا',
  GE: 'جورجيا', DE: 'ألمانيا', GH: 'غانا', GR: 'اليونان', GD: 'غرينادا',
  GT: 'غواتيمالا', GN: 'غينيا', GW: 'غينيا بيساو', GY: 'غيانا', HT: 'هايتي',
  HN: 'هندوراس', HK: 'هونغ كونغ', HU: 'المجر', IS: 'آيسلندا', IN: 'الهند',
  ID: 'إندونيسيا', IR: 'إيران', IQ: 'العراق', IE: 'أيرلندا', IL: 'إسرائيل',
  IT: 'إيطاليا', CI: 'ساحل العاج', JM: 'جامايكا', JP: 'اليابان', JO: 'الأردن',
  KZ: 'كازاخستان', KE: 'كينيا', KI: 'كيريباتي', KP: 'كوريا الشمالية', KR: 'كوريا الجنوبية',
  KW: 'الكويت', KG: 'قيرغيزستان', LA: 'لاوس', LV: 'لاتفيا', LB: 'لبنان',
  LS: 'ليسوتو', LR: 'ليبيريا', LY: 'ليبيا', LI: 'ليختنشتاين', LT: 'ليتوانيا',
  LU: 'لوكسمبورغ', MO: 'ماكاو', MG: 'مدغشقر', MW: 'ملاوي', MY: 'ماليزيا',
  MV: 'المالديف', ML: 'مالي', MT: 'مالطا', MH: 'جزر مارشال', MR: 'موريتانيا',
  MU: 'موريشيوس', MX: 'المكسيك', FM: 'ميكرونيزيا', MD: 'مولدوفا', MC: 'موناكو',
  MN: 'منغوليا', ME: 'الجبل الأسود', MA: 'المغرب', MZ: 'موزمبيق', MM: 'ميانمار',
  NA: 'ناميبيا', NR: 'ناورو', NP: 'نيبال', NL: 'هولندا', NZ: 'نيوزيلندا',
  NI: 'نيكاراغوا', NE: 'النيجر', NG: 'نيجيريا', MK: 'مقدونيا الشمالية', NO: 'النرويج',
  OM: 'عمان', PK: 'باكستان', PW: 'بالاو', PS: 'فلسطين', PA: 'بنما',
  PG: 'بابوا غينيا الجديدة', PY: 'باراغواي', PE: 'بيرو', PH: 'الفلبين',
  PL: 'بولندا', PT: 'البرتغال', PR: 'بورتوريكو', QA: 'قطر', RO: 'رومانيا',
  RU: 'روسيا', RW: 'رواندا', KN: 'سانت كيتس ونيفيس', LC: 'سانت لوسيا',
  VC: 'سانت فينسنت والغرينادين', WS: 'ساموا', SM: 'سان مارينو', ST: 'ساو تومي وبرينسيبي',
  SA: 'السعودية', SN: 'السنغال', RS: 'صربيا', SC: 'سيشل', SL: 'سيراليون',
  SG: 'سنغافورة', SK: 'سلوفاكيا', SI: 'سلوفينيا', SB: 'جزر سليمان', SO: 'الصومال',
  ZA: 'جنوب أفريقيا', SS: 'جنوب السودان', ES: 'إسبانيا', LK: 'سريلانكا',
  SD: 'السودان', SR: 'سورينام', SE: 'السويد', CH: 'سويسرا', SY: 'سوريا',
  TW: 'تايوان', TJ: 'طاجيكستان', TZ: 'تنزانيا', TH: 'تايلاند', TL: 'تيمور الشرقية',
  TG: 'توغو', TO: 'تونغا', TT: 'ترينيداد وتوباغو', TN: 'تونس', TR: 'تركيا',
  TM: 'تركمانستان', TV: 'توفالو', UG: 'أوغندا', UA: 'أوكرانيا', AE: 'الإمارات',
  GB: 'المملكة المتحدة', US: 'الولايات المتحدة', UY: 'أوروغواي', UZ: 'أوزبكستان',
  VU: 'فانواتو', VA: 'الفاتيكان', VE: 'فنزويلا', VN: 'فيتنام', YE: 'اليمن',
  ZM: 'زامبيا', ZW: 'زيمبابوي', AS: 'ساموا الأمريكية', AW: 'أروبا', IO: 'إقليم المحيط الهندي',
  VG: 'جزر فيرجن البريطانية', KY: 'جزر كايمان', CX: 'جزيرة عيد الميلاد', CC: 'جزر كوكوس',
  CK: 'جزر كوك', CW: 'كوراساو', FK: 'جزر فوكلاند', FO: 'جزر فارو', PF: 'بولينيزيا الفرنسية',
  GI: 'جبل طارق', GL: 'غرينلاند', GU: 'غوام', GG: 'غيرنزي', IM: 'جزيرة مان',
  JE: 'جيرسي', XK: 'كوسوفو', RE: 'ريونيون', BL: 'سان بارتليمي', SH: 'سانت هيلينا',
  MF: 'سان مارتن', PM: 'سان بيير وميكلون', SX: 'سينت مارتن', TL: 'تيمور الشرقية',
  TC: 'جزر تركس وكايكوس', VI: 'جزر فيرجن الأمريكية', WF: 'واليس وفوتونا', EH: 'الصحراء الغربية'
};

const RAW = [
  { country: 'Afghanistan', code: '93', iso: 'AF' }, { country: 'Albania', code: '355', iso: 'AL' },
  { country: 'Algeria', code: '213', iso: 'DZ' }, { country: 'American Samoa', code: '1-684', iso: 'AS' },
  { country: 'Andorra', code: '376', iso: 'AD' }, { country: 'Angola', code: '244', iso: 'AO' },
  { country: 'Anguilla', code: '1-264', iso: 'AI' }, { country: 'Antigua and Barbuda', code: '1-268', iso: 'AG' },
  { country: 'Argentina', code: '54', iso: 'AR' }, { country: 'Armenia', code: '374', iso: 'AM' },
  { country: 'Aruba', code: '297', iso: 'AW' }, { country: 'Australia', code: '61', iso: 'AU' },
  { country: 'Austria', code: '43', iso: 'AT' }, { country: 'Azerbaijan', code: '994', iso: 'AZ' },
  { country: 'Bahamas', code: '1-242', iso: 'BS' }, { country: 'Bahrain', code: '973', iso: 'BH' },
  { country: 'Bangladesh', code: '880', iso: 'BD' }, { country: 'Barbados', code: '1-246', iso: 'BB' },
  { country: 'Belarus', code: '375', iso: 'BY' }, { country: 'Belgium', code: '32', iso: 'BE' },
  { country: 'Belize', code: '501', iso: 'BZ' }, { country: 'Benin', code: '229', iso: 'BJ' },
  { country: 'Bermuda', code: '1-441', iso: 'BM' }, { country: 'Bhutan', code: '975', iso: 'BT' },
  { country: 'Bolivia', code: '591', iso: 'BO' }, { country: 'Bosnia and Herzegovina', code: '387', iso: 'BA' },
  { country: 'Botswana', code: '267', iso: 'BW' }, { country: 'Brazil', code: '55', iso: 'BR' },
  { country: 'Brunei', code: '673', iso: 'BN' }, { country: 'Bulgaria', code: '359', iso: 'BG' },
  { country: 'Burkina Faso', code: '226', iso: 'BF' }, { country: 'Burundi', code: '257', iso: 'BI' },
  { country: 'Cambodia', code: '855', iso: 'KH' }, { country: 'Cameroon', code: '237', iso: 'CM' },
  { country: 'Canada', code: '1', iso: 'CA' }, { country: 'Cape Verde', code: '238', iso: 'CV' },
  { country: 'Cayman Islands', code: '1-345', iso: 'KY' }, { country: 'Central African Republic', code: '236', iso: 'CF' },
  { country: 'Chad', code: '235', iso: 'TD' }, { country: 'Chile', code: '56', iso: 'CL' },
  { country: 'China', code: '86', iso: 'CN' }, { country: 'Colombia', code: '57', iso: 'CO' },
  { country: 'Comoros', code: '269', iso: 'KM' }, { country: 'Costa Rica', code: '506', iso: 'CR' },
  { country: 'Croatia', code: '385', iso: 'HR' }, { country: 'Cuba', code: '53', iso: 'CU' },
  { country: 'Curacao', code: '599', iso: 'CW' }, { country: 'Cyprus', code: '357', iso: 'CY' },
  { country: 'Czech Republic', code: '420', iso: 'CZ' }, { country: 'Democratic Republic of the Congo', code: '243', iso: 'CD' },
  { country: 'Denmark', code: '45', iso: 'DK' }, { country: 'Djibouti', code: '253', iso: 'DJ' },
  { country: 'Dominica', code: '1-767', iso: 'DM' }, { country: 'Dominican Republic', code: '1-809', iso: 'DO' },
  { country: 'East Timor', code: '670', iso: 'TL' }, { country: 'Ecuador', code: '593', iso: 'EC' },
  { country: 'Egypt', code: '20', iso: 'EG' }, { country: 'El Salvador', code: '503', iso: 'SV' },
  { country: 'Equatorial Guinea', code: '240', iso: 'GQ' }, { country: 'Eritrea', code: '291', iso: 'ER' },
  { country: 'Estonia', code: '372', iso: 'EE' }, { country: 'Ethiopia', code: '251', iso: 'ET' },
  { country: 'Fiji', code: '679', iso: 'FJ' }, { country: 'Finland', code: '358', iso: 'FI' },
  { country: 'France', code: '33', iso: 'FR' }, { country: 'Gabon', code: '241', iso: 'GA' },
  { country: 'Gambia', code: '220', iso: 'GM' }, { country: 'Georgia', code: '995', iso: 'GE' },
  { country: 'Germany', code: '49', iso: 'DE' }, { country: 'Ghana', code: '233', iso: 'GH' },
  { country: 'Greece', code: '30', iso: 'GR' }, { country: 'Grenada', code: '1-473', iso: 'GD' },
  { country: 'Guatemala', code: '502', iso: 'GT' }, { country: 'Guinea', code: '224', iso: 'GN' },
  { country: 'Guinea-Bissau', code: '245', iso: 'GW' }, { country: 'Guyana', code: '592', iso: 'GY' },
  { country: 'Haiti', code: '509', iso: 'HT' }, { country: 'Honduras', code: '504', iso: 'HN' },
  { country: 'Hong Kong', code: '852', iso: 'HK' }, { country: 'Hungary', code: '36', iso: 'HU' },
  { country: 'Iceland', code: '354', iso: 'IS' }, { country: 'India', code: '91', iso: 'IN' },
  { country: 'Indonesia', code: '62', iso: 'ID' }, { country: 'Iran', code: '98', iso: 'IR' },
  { country: 'Iraq', code: '964', iso: 'IQ' }, { country: 'Ireland', code: '353', iso: 'IE' },
  { country: 'Israel', code: '972', iso: 'IL' }, { country: 'Italy', code: '39', iso: 'IT' },
  { country: 'Ivory Coast', code: '225', iso: 'CI' }, { country: 'Jamaica', code: '1-876', iso: 'JM' },
  { country: 'Japan', code: '81', iso: 'JP' }, { country: 'Jordan', code: '962', iso: 'JO' },
  { country: 'Kazakhstan', code: '7', iso: 'KZ' }, { country: 'Kenya', code: '254', iso: 'KE' },
  { country: 'Kiribati', code: '686', iso: 'KI' }, { country: 'Kosovo', code: '383', iso: 'XK' },
  { country: 'Kuwait', code: '965', iso: 'KW' }, { country: 'Kyrgyzstan', code: '996', iso: 'KG' },
  { country: 'Laos', code: '856', iso: 'LA' }, { country: 'Latvia', code: '371', iso: 'LV' },
  { country: 'Lebanon', code: '961', iso: 'LB' }, { country: 'Lesotho', code: '266', iso: 'LS' },
  { country: 'Liberia', code: '231', iso: 'LR' }, { country: 'Libya', code: '218', iso: 'LY' },
  { country: 'Liechtenstein', code: '423', iso: 'LI' }, { country: 'Lithuania', code: '370', iso: 'LT' },
  { country: 'Luxembourg', code: '352', iso: 'LU' }, { country: 'Macao', code: '853', iso: 'MO' },
  { country: 'North Macedonia', code: '389', iso: 'MK' }, { country: 'Madagascar', code: '261', iso: 'MG' },
  { country: 'Malawi', code: '265', iso: 'MW' }, { country: 'Malaysia', code: '60', iso: 'MY' },
  { country: 'Maldives', code: '960', iso: 'MV' }, { country: 'Mali', code: '223', iso: 'ML' },
  { country: 'Malta', code: '356', iso: 'MT' }, { country: 'Marshall Islands', code: '692', iso: 'MH' },
  { country: 'Mauritania', code: '222', iso: 'MR' }, { country: 'Mauritius', code: '230', iso: 'MU' },
  { country: 'Mexico', code: '52', iso: 'MX' }, { country: 'Micronesia', code: '691', iso: 'FM' },
  { country: 'Moldova', code: '373', iso: 'MD' }, { country: 'Monaco', code: '377', iso: 'MC' },
  { country: 'Mongolia', code: '976', iso: 'MN' }, { country: 'Montenegro', code: '382', iso: 'ME' },
  { country: 'Morocco', code: '212', iso: 'MA' }, { country: 'Mozambique', code: '258', iso: 'MZ' },
  { country: 'Myanmar', code: '95', iso: 'MM' }, { country: 'Namibia', code: '264', iso: 'NA' },
  { country: 'Nauru', code: '674', iso: 'NR' }, { country: 'Nepal', code: '977', iso: 'NP' },
  { country: 'Netherlands', code: '31', iso: 'NL' }, { country: 'New Zealand', code: '64', iso: 'NZ' },
  { country: 'Nicaragua', code: '505', iso: 'NI' }, { country: 'Niger', code: '227', iso: 'NE' },
  { country: 'Nigeria', code: '234', iso: 'NG' }, { country: 'North Korea', code: '850', iso: 'KP' },
  { country: 'Norway', code: '47', iso: 'NO' }, { country: 'Oman', code: '968', iso: 'OM' },
  { country: 'Pakistan', code: '92', iso: 'PK' }, { country: 'Palau', code: '680', iso: 'PW' },
  { country: 'Palestine', code: '970', iso: 'PS' }, { country: 'Panama', code: '507', iso: 'PA' },
  { country: 'Papua New Guinea', code: '675', iso: 'PG' }, { country: 'Paraguay', code: '595', iso: 'PY' },
  { country: 'Peru', code: '51', iso: 'PE' }, { country: 'Philippines', code: '63', iso: 'PH' },
  { country: 'Poland', code: '48', iso: 'PL' }, { country: 'Portugal', code: '351', iso: 'PT' },
  { country: 'Puerto Rico', code: '1-787', iso: 'PR' }, { country: 'Qatar', code: '974', iso: 'QA' },
  { country: 'Republic of the Congo', code: '242', iso: 'CG' }, { country: 'Romania', code: '40', iso: 'RO' },
  { country: 'Russia', code: '7', iso: 'RU' }, { country: 'Rwanda', code: '250', iso: 'RW' },
  { country: 'Saint Kitts and Nevis', code: '1-869', iso: 'KN' }, { country: 'Saint Lucia', code: '1-758', iso: 'LC' },
  { country: 'Saint Vincent and the Grenadines', code: '1-784', iso: 'VC' }, { country: 'Samoa', code: '685', iso: 'WS' },
  { country: 'San Marino', code: '378', iso: 'SM' }, { country: 'Sao Tome and Principe', code: '239', iso: 'ST' },
  { country: 'Saudi Arabia', code: '966', iso: 'SA' }, { country: 'Senegal', code: '221', iso: 'SN' },
  { country: 'Serbia', code: '381', iso: 'RS' }, { country: 'Seychelles', code: '248', iso: 'SC' },
  { country: 'Sierra Leone', code: '232', iso: 'SL' }, { country: 'Singapore', code: '65', iso: 'SG' },
  { country: 'Slovakia', code: '421', iso: 'SK' }, { country: 'Slovenia', code: '386', iso: 'SI' },
  { country: 'Solomon Islands', code: '677', iso: 'SB' }, { country: 'Somalia', code: '252', iso: 'SO' },
  { country: 'South Africa', code: '27', iso: 'ZA' }, { country: 'South Korea', code: '82', iso: 'KR' },
  { country: 'South Sudan', code: '211', iso: 'SS' }, { country: 'Spain', code: '34', iso: 'ES' },
  { country: 'Sri Lanka', code: '94', iso: 'LK' }, { country: 'Sudan', code: '249', iso: 'SD' },
  { country: 'Suriname', code: '597', iso: 'SR' }, { country: 'Swaziland', code: '268', iso: 'SZ' },
  { country: 'Sweden', code: '46', iso: 'SE' }, { country: 'Switzerland', code: '41', iso: 'CH' },
  { country: 'Syria', code: '963', iso: 'SY' }, { country: 'Taiwan', code: '886', iso: 'TW' },
  { country: 'Tajikistan', code: '992', iso: 'TJ' }, { country: 'Tanzania', code: '255', iso: 'TZ' },
  { country: 'Thailand', code: '66', iso: 'TH' }, { country: 'Togo', code: '228', iso: 'TG' },
  { country: 'Tonga', code: '676', iso: 'TO' }, { country: 'Trinidad and Tobago', code: '1-868', iso: 'TT' },
  { country: 'Tunisia', code: '216', iso: 'TN' }, { country: 'Turkey', code: '90', iso: 'TR' },
  { country: 'Turkmenistan', code: '993', iso: 'TM' }, { country: 'Tuvalu', code: '688', iso: 'TV' },
  { country: 'Uganda', code: '256', iso: 'UG' }, { country: 'Ukraine', code: '380', iso: 'UA' },
  { country: 'United Arab Emirates', code: '971', iso: 'AE' }, { country: 'United Kingdom', code: '44', iso: 'GB' },
  { country: 'United States', code: '1', iso: 'US' }, { country: 'Uruguay', code: '598', iso: 'UY' },
  { country: 'Uzbekistan', code: '998', iso: 'UZ' }, { country: 'Vanuatu', code: '678', iso: 'VU' },
  { country: 'Vatican', code: '379', iso: 'VA' }, { country: 'Venezuela', code: '58', iso: 'VE' },
  { country: 'Vietnam', code: '84', iso: 'VN' }, { country: 'Yemen', code: '967', iso: 'YE' },
  { country: 'Zambia', code: '260', iso: 'ZM' }, { country: 'Zimbabwe', code: '263', iso: 'ZW' }
];

export const countriesWithDialCode = RAW.map(({ country, code, iso }) => ({
  iso,
  dialCode: normalizeDialCode(code),
  nameEn: country,
  nameAr: NAME_AR_BY_ISO[iso] || country
}));

/** Flag image URL from ISO code (e.g. SA -> flagcdn) */
export function getFlagUrl(iso) {
  if (!iso || iso.length !== 2) return '';
  const code = iso.toUpperCase();
  if (code === 'XK') return 'https://flagcdn.com/w40/xk.png';
  return `https://flagcdn.com/w40/${iso.toLowerCase()}.png`;
}
